---
title: "캐릭터 복셀 변환"
categories: [Daily/Work]
tags: [Work]
---



# 캐릭터 복셀 변환 작업...

- 아래 친구를 복셀화 해보기로 하자.
- 모델은 유니티짱 홈페이지에서 다운로드 가능

![이미지](https://pbs.twimg.com/media/DuCktNpVAAAAQll?format=jpg&name=medium)





### 1. 단순 변환 시도

![simple_lize](https://raw.githubusercontent.com/hns17/ImageContainer/main/img/simple_lize.gif)

- 잘 변환된 것 처럼 보이지만 정적인 상태와 달리 스키닝 애니메이션을 하게되면  복셀이 움직임과 함께 빈 공간이 생김
- 거기다 BackfaceCull(중앙)을 가하면 해당 부위가 완전 비어 버림.
  - 여기서 Backface는 모델의 안쪽에 위치한 복셀의 면을 뜻함



### 2. 폴리곤 처럼 정점을 연결하면?

![image-20220919010024161](https://raw.githubusercontent.com/hns17/ImageContainer/main/img/image-20220919010024161.png)

- 폴리곤 오브젝트처럼 정점을 연결하면 정점도 줄고 빈공간도 없어져 뚫리는 문제 해결... 은 가능한데 근본적인 문제가 생김
- 복셀의 형태가 변경(**팔 부위**)되어 특징이 전혀 살지 않음.
- 폴리곤 같은 경우 메쉬가 늘어나도 텍스처만 잘 바르면 크게 문제되지 않으나 복셀은 하나의 색만 가지고, 동작이 커져 형태가 크게 변하면(늘어나거나, 줄거나) 전혀 예쁘지가 않음. 차라리 그냥 뚫리는게 예뻐보임, 복셀화를 할 이유가 없어짐



### 3. 복셀의 사이즈를 늘려 각 복셀을 겹치게 한다면?

![overlap](https://raw.githubusercontent.com/hns17/ImageContainer/main/img/overlap.gif)

- 겹친 모델(오른쪽)을 보면 빈 공간 문제(팔, 무릎, 스커트 등)는 어느정도 해결되지만 기본 모션과 크게 차이나는 모션(팔을 들어 올리거나)에서는 여전히 문제가 생김
- 크기를 더 늘리면 되지만  너무 크게(2배 이상) 늘리면 디테일한 표현이 망가져 버림
- 추가적으로 겹쳐진 면 때문에 렌더링시 z-fight 문제(리본 부분)가 발생해 지글지글 거림



### 4. z-fight  문제 해결하기

- 복셀 중첩에 따른 z-fight 문제는 각 복셀의 위치를 조금 씩 어긋나게 변경하면 어느정도 해결 가능
- 어긋나는 범위를 너무 적게 주면 애니메이션시 일부 메쉬가 겹치는 경우가 발생함
- 애초에 복셀은 각지게 표현되기 때문에 위치가 조금씩 어그러져도(들어가거나 나오거나) 이상하지 않음



### 5. 복셀화를 위한 모델을 따로 관리

![image-20220919094720280](https://raw.githubusercontent.com/hns17/ImageContainer/main/img/image-20220919094720280.png)

- 스키닝 애니메이션으로 문제가 되는 부위(몸통, 팔, 무릎, 어깨 등)의 기본 뼈대를 길게 펼쳐서 피부를 늘림

- 늘어진 모델을 대상으로 메쉬 복셀화 후 본 변경하기

- 복셀 겹치기와 같이 적용하면 빈 공간 문제는 대부분 해결



### 6. 정점 색상 사용하기

![result](https://raw.githubusercontent.com/hns17/ImageContainer/main/img/result.gif)

- 복셀은 하나의 색상 만을 가지므로 정점색상을 이용한다면 텍스쳐 없이 하나의 마테리얼로 동일한 표현이 가능
- 단점은 빠르게 텍스쳐 교체를 통한 표현(다른 색상의 텍스쳐나, 문양이나)이 불가능해진다
  - 근데 어차피 모델마다 대응되는 텍스쳐 따로 하나씩 가지니 문제 될 일이 있는가...
  - 같은 메쉬에 텍스쳐 여러개로 다양화 하는 경우 아니면 문제 없을듯?



### 7. 표정 문제

- 표정 변화를 본으로 처리하면 되겠지만, 블렌드 쉐이프의 경우 아무리 생각해도 대응 가능한 방법이 떠오르지 않음
  - 사용하려면 복셀화 후 모델링 툴을 이용해 블렌드 쉐이프로 표정 다시 구성해야 함



### 8. 결과

![result2](C:/Users/hns17/Desktop/Resource/Voxelize/result2.gif)



- 모델링 툴(맥스 라던지... 블렌더라 던지)에는 좋은 Plugin이 많다..

- ...리깅이나 텍스쳐링을 할 줄 알면 편하지 않았을까...